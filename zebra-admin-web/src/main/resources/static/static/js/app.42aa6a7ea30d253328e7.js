webpackJsonp([1],{"+skl":function(t,e){},"6lkG":function(t,e){},FBSW:function(t,e){},It0I:function(t,e){},LW0X:function(t,e,a){"use strict";var s="ivu-icon",n={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return s+" "+s+"-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},i={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("i",{class:t.classes,style:t.styles})},staticRenderFns:[]},r=a("VU/8")(n,i,!1,null,null,null);e.a=r.exports},Lxn6:function(t,e,a){var s=a("mtWM");e.install=function(t,e){t.prototype.initEnv=function(){var t=this;s.get("/i/system/env").then(function(e){var a=e.data;t.$store.state.envs=a.envs;for(var s=window.localStorage.getItem("env"),n=s&&"undefined"!=s?s:a.currentEnv,i=0;i<a.envs.length;++i)if(n===a.envs[i]){t.$store.state.currentEnv=a.envs[i];break}t.$store.state.init=!0}).catch(function(e){console.log(e),t.$Notice.error({title:"初始化环境信息失败",desc:e.message})})},t.prototype.validateParams=function(t){if(null==t||""==t.trim())return!1;var e=this,a=!0;return this.$refs[t].validate(function(t){t||(a=!1,e.$Notice.error({title:"验证失败"}))}),a},t.prototype.trim=function(t){return t.replace(/(^\s*)|(\s*$)/g,"")}}},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),n=a("BTaQ"),i=a.n(n),r=(a("+skl"),a("/ocq")),o=(a("mtWM"),{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Menu",{attrs:{mode:"horizontal",theme:t.theme}},[a("div",{staticClass:"layout-menu"},[a("Button",{staticStyle:{color:"white","z-index":"1"},attrs:{type:"ghost",icon:"navicon-round"},on:{click:function(e){t.showSide()}}})],1),t._v(" "),a("div",{staticClass:"layout-logo"},[a("a",{staticClass:"logo",attrs:{href:"/"}},[t._v("\n            Zebra 管理平台\n        ")])]),t._v(" "),a("div",{staticClass:"layout-nav"},[a("div",{staticClass:"header-nav-list"},[a("a",{staticClass:"ivu-menu-item",staticStyle:{"text-align":"center","font-size":"14px"},attrs:{href:"https://github.com/dianping/zebra/wiki",target:"view_window"}},[t._v("\n                文档\n            ")]),t._v(" "),a("a",{staticClass:"ivu-menu-item",staticStyle:{"text-align":"center","font-size":"14px"},attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("\n                帮助&支持\n            ")])])])])},staticRenderFns:[]});var l=a("VU/8")({props:["message"],data:function(){return{theme:"light",name:"",headUrl:null,value:null,menuFocus:!1,keyWord:null,searchLoading:!1,selectGroups:null}},methods:{showSide:function(){var t=this.message.showSide;this.message.showSide=!t}}},o,!1,function(t){a("vfVZ")},"data-v-305ebdc2",null).exports,d=a("bOdI"),c=a.n(d),u="ivu-icon",p={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return u+" "+u+"-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},v={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},f=a("VU/8")(p,v,!1,null,null,null).exports;a("BO1k");function h(t,e){if(t){for(var a=t.className,s=(e||"").split(" "),n=0,i=s.length;n<i;n++){var r=s[n];r&&(t.classList?t.classList.add(r):hasClass(t,r)||(a+=" "+r))}t.classList||(t.className=a)}}function m(t,e){if(t&&e){for(var a=e.split(" "),s=" "+t.className+" ",n=0,i=a.length;n<i;n++){var r=a[n];r&&(t.classList?t.classList.remove(r):hasClass(t,r)&&(s=s.replace(" "+r+" "," ")))}t.classList||(t.className=trim(s))}}function g(t,e){if(!t||!e)return null;"float"===(e=e.replace(SPECIAL_CHARS_REGEXP,function(t,e,a,s){return s?a.toUpperCase():a}).replace(MOZ_HACK_REGEXP,"Moz$1"))&&(e="cssFloat");try{var a=document.defaultView.getComputedStyle(t,"");return t.style[e]||a?a[e]:null}catch(a){return t.style[e]}}function b(t,e,a){a="string"==typeof e?[e]:e;for(var s=t.$parent,n=s.$options.name;s&&(!n||a.indexOf(n)<0);)(s=s.$parent)&&(n=s.$options.name);return s}function y(t,e){return t.$children.reduce(function(t,a){a.$options.name===e&&t.push(a);var s=y(a,e);return t.concat(s)},[])}var _={beforeEnter:function(t){h(t,"collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height="0",t.style.paddingTop=0,t.style.paddingBottom=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.overflow="hidden"},afterEnter:function(t){m(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden"},leave:function(t){0!==t.scrollHeight&&(h(t,"collapse-transition"),t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0)},afterLeave:function(t){m(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom}},x="ivu-menu",C={name:"Submenu",components:{Icon:f,CollapseTransition:{name:"CollapseTransition",functional:!0,render:function(t,e){var a=e.children;return t("transition",{on:_},a)}}},mixins:[{data:function(){return{menu:b(this,"Menu")}},computed:{hasParentSubmenu:function(){return b(this,"Submenu")},parentSubmenuNum:function(){return function t(e,a){var s=[];return e.$parent?(e.$parent.$options.name===a&&s.push(e.$parent),s.concat(t(e.$parent,a))):[]}(this,"Submenu").length},mode:function(){return this.menu.mode}}}],props:{name:{type:[String,Number],required:!0}},data:function(){return{baseClass:x,active:!1,opened:!1,dropWidth:parseFloat(g(this.$el,"width"))}},computed:{classes:function(){var t;return[x+"-submenu",(t={},c()(t,x+"-item-active",this.active&&!this.hasParentSubmenu),c()(t,x+"-opened",this.opened),c()(t,x+"-submenu-has-parent-submenu",this.hasParentSubmenu),c()(t,x+"-child-item-active",this.active),t)]},accordion:function(){return this.menu.accordion},dropStyle:function(){var t={};return this.dropWidth&&(t.minWidth=this.dropWidth+"px"),t},titleStyle:function(){return this.hasParentSubmenu?{paddingLeft:43+24*(this.parentSubmenuNum-1)+"px"}:{}}},methods:{handleClick:function(){if("horizontal"!==this.mode){var t=this.opened;this.$emit("on-submenu-select",this.name),this.accordion&&this.$parent.$children.forEach(function(t){"Submenu"===t.$options.name&&(t.opened=!1)}),this.opened=!t,this.menu.updateOpenKeys(this.name)}}},mounted:function(){var t=this;this.$on("on-menu-item-select",function(e){return t.dispatch("Menu","on-menu-item-select",e),!0}),this.$on("on-update-active-name",function(e){b(t,"Submenu")&&t.dispatch("Submenu","on-update-active-name",e),y(t,"Submenu")&&y(t,"Submenu").forEach(function(t){t.active=!1}),t.active=e})}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{class:t.classes},[a("div",{ref:"reference",class:[t.baseClass+"-submenu-title"],style:t.titleStyle,on:{click:function(e){e.stopPropagation(),t.handleClick(e)}}},[t._t("title"),t._v(" "),a("Icon",{staticClass:"ivu-menu-submenu-title-icon",attrs:{type:"ios-arrow-down"}})],2),t._v(" "),a("collapse-transition",[a("ul",{directives:[{name:"show",rawName:"v-show",value:t.opened,expression:"opened"}],class:[t.baseClass]},[t._t("default")],2)])],1)},staticRenderFns:[]},S={components:{ZSubmenu:a("VU/8")(C,w,!1,null,null,null).exports},data:function(){return{res:null,corps:[]}},methods:{}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",{attrs:{span:"24"}},[a("Menu",{staticStyle:{width:"100%"}},[a("router-link",{staticStyle:{color:"white"},attrs:{to:"/"}},[a("MenuItem",{attrs:{name:"home"}},[a("Icon",{attrs:{type:"ios-home"}}),t._v("\n                主页\n            ")],1)],1),t._v(" "),a("router-link",{staticStyle:{color:"white"},attrs:{to:"/jdbcrefOverview"}},[a("MenuItem",{attrs:{name:"jdbcrefView"}},[a("Icon",{attrs:{type:"social-buffer"}}),t._v("\n            读写分离\n            ")],1)],1),t._v(" "),a("router-link",{staticStyle:{color:"white"},attrs:{to:"/shardOverview"}},[a("MenuItem",{attrs:{name:"shardView"}},[a("Icon",{attrs:{type:"android-share-alt"}}),t._v("\n            分库分表\n            ")],1)],1),t._v(" "),a("router-link",{staticStyle:{color:"white","text-decoration":"none"},attrs:{to:"/envConfig"}},[a("MenuItem",{attrs:{name:"envView"}},[a("Icon",{attrs:{type:"ios-paper"}}),t._v("\n                环境管理\n            ")],1)],1)],1)],1)],1)},staticRenderFns:[]};var $={data:function(){return{parentData:{showSide:!0}}},components:{top:l,side:a("VU/8")(S,k,!1,function(t){a("NRQY")},"data-v-7c53171e",null).exports},created:function(){}},N={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",[a("Header",[a("top",{attrs:{message:t.parentData}})],1),t._v(" "),a("Layout",{staticStyle:{"margin-top":"58px"}},[a("transition",{attrs:{name:"sidebar-transition"}},[a("Sider",{directives:[{name:"show",rawName:"v-show",value:t.parentData.showSide,expression:"parentData.showSide"}],staticStyle:{width:"220px","min-width":"200px","max-width":"260px",flex:"0 0 220px"}},[a("side")],1)],1),t._v(" "),a("Content",[a("router-view")],1)],1)],1)},staticRenderFns:[]},z=a("VU/8")($,N,!1,null,null,null).exports,R=a("EMb8"),I=a("9Xvl"),B="ivu-avatar",M={name:"Avatar",components:{Icon:R.a},props:{shape:{validator:function(t){return Object(I.a)(t,["circle","square"])},default:"circle"},size:{validator:function(t){return Object(I.a)(t,["small","large","default"])},default:"default"},src:{type:String},icon:{type:String}},data:function(){return{prefixCls:B,scale:1,childrenWidth:0,isSlotShow:!1}},computed:{classes:function(){var t;return[""+B,B+"-"+this.shape,B+"-"+this.size,(t={},c()(t,B+"-image",!!this.src),c()(t,B+"-icon",!!this.icon),t)]},childrenStyle:function(){var t={};return this.isSlotShow&&(t={msTransform:"scale("+this.scale+")",WebkitTransform:"scale("+this.scale+")",transform:"scale("+this.scale+")",position:"absolute",display:"inline-block",left:"calc(50% - "+Math.round(this.childrenWidth/2)+"px)"}),t}},methods:{setScale:function(){if(this.isSlotShow=!this.src&&!this.icon,this.$refs.children){this.childrenWidth=this.$refs.children.offsetWidth;var t=this.$el.getBoundingClientRect().width;t-8<this.childrenWidth?this.scale=(t-8)/this.childrenWidth:this.scale=1}}},mounted:function(){this.setScale()},updated:function(){this.setScale()}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{class:t.classes},[t.src?a("img",{attrs:{src:t.src}}):t.icon?a("Icon",{attrs:{type:t.icon}}):a("span",{ref:"children",class:[t.prefixCls+"-string"],style:t.childrenStyle},[t._t("default")],2)],1)},staticRenderFns:[]},j={components:{Avatar:a("VU/8")(M,D,!1,null,null,null).exports},computed:{envs:function(){return this.$store.state.envs},init:function(){return this.$store.state.init}},watch:{init:function(t,e){t&&(this.selectedEnv=this.$store.state.currentEnv)}}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",{attrs:{span:"24"}},[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card-body",staticStyle:{height:"400px",width:"100%","margin-bottom":"10px","background-image":"url(/static/image/zebra-nav.png)","background-repeat":"no-repeat","background-size":"100% 100%","-moz-background-size":"100% 100%"}},[a("span",{staticStyle:{display:"block","font-size":"32px","font-weight":"bold",color:"white"}},[t._v("\n                    分布式数据库中间件Zebra\n                ")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{color:"#fff","font-size":"16px"}},[a("b",[t._v("Zebra")]),t._v("是一款基于JDBC API协议上开发出的的数据库访问层 (Data Access Layer) 解决方案，具备"),a("b",[t._v("轻量灵活、"),a("br"),t._v("高可用、高性能等特性")]),t._v("。\n                        专注于解决传统关系型数据库的扩展性问题，在分布式场景下充分利用关系型数据"),a("br"),t._v("库的能力，提供诸如"),a("b",[t._v("动态数据源、读写分离、分库分表、数据库请求监控、等")]),t._v("功能。Zebra由美团点评\n                        基础"),a("br"),t._v("架构团队自主研发, 目前应用于公司内部外卖、配送、酒旅等各大业务线，经过丰富场景验证，品质值得信赖。\n                    ")])])]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto"}},[a("i",{staticClass:"ivu-icon ivu-icon-refresh"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("动态数据源")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            提供动态的数据源刷新能力，实时响应数据源变更，支撑底层存储的平滑扩展。\n                        ")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto"}},[a("i",{staticClass:"ivu-icon ivu-icon-merge"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("读写分离")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            提供对底层存储的读写分离能力，支持单库事务，强制走主/从库，从库流量调节。\n                        ")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto",padding:"0"}},[a("i",{staticClass:"fa fa-sitemap"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("分库分表")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            提供hash和range 2种方式进行数据分片, sql支持度丰富, 解决大表大库的烦恼。\n                        ")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto",padding:"0"}},[a("i",{staticClass:"ivu-icon ivu-icon-ios-pulse-strong"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("监控打点")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            提供数据库请求的监控，丰富的监控打点使调用链路清晰可见，方便业务排查问题。\n                        ")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto",padding:"0"}},[a("i",{staticClass:"ivu-icon ivu-icon-ios-shuffle-strong"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("异步化请求")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            提供异步化的数据库访问能力，在数据库密级型业务中有效提升系统吞吐量。\n                        ")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card home-bordered"},[a("div",{staticClass:"ivu-card-body"},[a("span",{staticClass:"ivu-avatar ivu-avatar-circle avatar-title avatar-icon",staticStyle:{"background-color":"rgb(58, 128, 194)",display:"block",margin:"0 auto",padding:"0"}},[a("i",{staticClass:"ivu-icon ivu-icon-ios-color-filter-outline"})]),t._v(" "),a("br"),t._v(" "),a("h2",{staticStyle:{"text-align":"center"}},[t._v("多数据源")]),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{display:"block",padding:"0 50px 0 50px"}},[t._v("\n                            内置多数据源配置能力，解决同时访问多个数据库场景下复杂配置的难题。\n                        ")])])])])],1),t._v(" "),a("Col",{attrs:{span:"16"}},[a("div",{staticClass:"ivu-card",staticStyle:{padding:"10px","margin-top":"20px",height:"500px"}},[a("div",{staticClass:"ivu-card-head"},[a("b",[t._v("问题与文档")])]),t._v(" "),a("div",{staticClass:"ivu-card-body"},[a("span",{staticStyle:{"font-weight":"bold","font-size":"24px"}},[t._v("快速开始")]),t._v(" "),a("br"),t._v(" "),a("span",[t._v("快速搭建项目")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("https://github.com/dianping/zebra")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{"font-weight":"bold","font-size":"24px"}},[t._v("设计说明")]),t._v(" "),a("br"),t._v(" "),a("span",[t._v("总体设计")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("https://github.com/dianping/zebra")]),t._v(" "),a("br"),t._v(" "),a("span",[t._v("路由设计")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("https://github.com/dianping/zebra")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{"font-weight":"bold","font-size":"24px"}},[t._v("关于我们")]),t._v(" "),a("br"),t._v(" "),a("span",[t._v("项目地址")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("https://github.com/dianping/zebra")]),t._v(" "),a("br"),t._v(" "),a("span",[t._v("wiki地址")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra/wiki",target:"view_window"}},[t._v("https://github.com/dianping/zebra/wiki")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{"font-weight":"bold","font-size":"24px"}},[t._v("FAQ")]),t._v(" "),a("br"),t._v(" "),a("a",{attrs:{href:"https://github.com/dianping/zebra",target:"view_window"}},[t._v("https://github.com/dianping/zebra")])])])]),t._v(" "),a("Col",{attrs:{span:"8"}},[a("div",{staticClass:"ivu-card",staticStyle:{padding:"10px","margin-top":"20px","margin-left":"10px",height:"500px"}},[a("div",{staticClass:"ivu-card-head"},[a("b",[t._v("路线图")])]),t._v(" "),a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"10px 0 0 0"}},[a("Timeline",[a("TimelineItem",[a("p",{staticClass:"time"},[t._v("2.x 版本")]),t._v(" "),a("p",{staticClass:"content"},[a("Tag",{attrs:{color:"green"}},[t._v("读写分离")]),t._v(" "),a("br"),t._v(" "),a("Tag",{attrs:{color:"green"}},[t._v("分库分表")]),t._v(" "),a("br"),t._v(" "),a("Tag",{attrs:{color:"green"}},[t._v("监控")]),t._v(" "),a("br"),t._v(" "),a("Tag",{attrs:{color:"green"}},[t._v("异步化dao")])],1)]),t._v(" "),a("TimelineItem",[a("p",{staticClass:"time"},[t._v("3.x 版本")]),t._v(" "),a("p",{staticClass:"content"},[a("Tag",{attrs:{color:"yellow"}},[t._v("分布式sql引擎")]),t._v(" "),a("br"),t._v(" "),a("Tag",{attrs:{color:"yellow"}},[t._v("分布式事务")]),t._v(" "),a("br"),t._v(" "),a("Tag",{attrs:{color:"grey"}},[t._v("Proxy")])],1)]),t._v(" "),a("TimelineItem",[a("p",{staticClass:"time"},[t._v("未来")]),t._v(" "),a("p",{staticClass:"content"},[a("Tag",{attrs:{color:"blue"}},[t._v("欢迎共建")])],1)])],1)],1)])])],1)],1)},staticRenderFns:[]};var E=a("VU/8")(j,A,!1,function(t){a("t8sK")},"data-v-000ad8e3",null).exports,T=a("mtWM"),F={name:"jdbcrefConfigForm",props:{dsConfig:{env:null,owner:null,jdbcref:null,dbName:null,description:null,DBAddresses:[]}},data:function(){return{envs:[]}},created:function(){var t=this;T.get("/i/zkConfig/getEnv").then(function(e){t.envs=e.data})},methods:{addDB:function(){this.dsConfig.DBAddresses.push({DBAddress:"",readOrWrite:"读",weight:0})},delDB:function(){this.dsConfig.DBAddresses.pop()}}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{ref:"dsConfig",attrs:{model:t.dsConfig,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{prop:"jdbcref"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("jdbcref值")]),t._v(" "),a("Input",{staticStyle:{width:"285px"},attrs:{placeholder:"jdbcref"},model:{value:t.dsConfig.jdbcref,callback:function(e){t.$set(t.dsConfig,"jdbcref",e)},expression:"dsConfig.jdbcref"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"env"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("环境")]),t._v(" "),a("Select",{staticStyle:{width:"285px"},attrs:{placeholder:"env",transfer:!0},model:{value:t.dsConfig.env,callback:function(e){t.$set(t.dsConfig,"env",e)},expression:"dsConfig.env"}},t._l(t.envs,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1),t._v(" "),t._l(t.dsConfig.DBAddresses,function(e,s){return a("div",[a("FormItem",{attrs:{prop:"DBAddress"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("数据库地址"+t._s(s))]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"ip:port"},model:{value:t.dsConfig.DBAddresses[s].DBAddress,callback:function(e){t.$set(t.dsConfig.DBAddresses[s],"DBAddress",e)},expression:"dsConfig.DBAddresses[index].DBAddress"}}),t._v(" "),a("RadioGroup",{staticStyle:{"margin-left":"4px"},attrs:{type:"button"},model:{value:t.dsConfig.DBAddresses[s].readOrWrite,callback:function(e){t.$set(t.dsConfig.DBAddresses[s],"readOrWrite",e)},expression:"dsConfig.DBAddresses[index].readOrWrite"}},[a("Radio",{staticStyle:{"padding-left":"8px"},attrs:{label:"读"}}),t._v(" "),a("Radio",{staticStyle:{"padding-left":"8px"},attrs:{label:"写"}})],1),t._v(" "),a("Tooltip",{attrs:{content:"流量占比"}},[a("InputNumber",{staticStyle:{"margin-left":"4px",width:"40px"},attrs:{min:0,disabled:"写"===t.dsConfig.DBAddresses[s].readOrWrite},model:{value:t.dsConfig.DBAddresses[s].weight,callback:function(e){t.$set(t.dsConfig.DBAddresses[s],"weight",e)},expression:"dsConfig.DBAddresses[index].weight"}})],1),t._v(" "),a("Span",0==s?[a("Button",{staticStyle:{"padding-top":"1px","margin-left":"6px"},attrs:{type:"primary",shape:"circle",icon:"plus-round",size:"small"},on:{click:t.addDB}})]:[a("Button",{staticStyle:{"padding-top":"1px","margin-left":"6px"},attrs:{type:"dashed",shape:"circle",icon:"minus-round",size:"small"},on:{click:t.delDB}})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"7px"}},[a("Input",{staticStyle:{width:"166px"},attrs:{placeholder:"userName"},model:{value:t.dsConfig.DBAddresses[s].userName,callback:function(e){t.$set(t.dsConfig.DBAddresses[s],"userName",e)},expression:"dsConfig.DBAddresses[index].userName"}}),t._v(" "),a("Input",{staticStyle:{width:"166px"},attrs:{placeholder:"password",type:"password"},model:{value:t.dsConfig.DBAddresses[s].password,callback:function(e){t.$set(t.dsConfig.DBAddresses[s],"password",e)},expression:"dsConfig.DBAddresses[index].password"}})],1)],1)],1)}),t._v(" "),a("FormItem",{attrs:{prop:"dbName"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("数据库名")]),t._v(" "),a("Input",{staticStyle:{width:"285px"},attrs:{placeholder:"dbName"},model:{value:t.dsConfig.dbName,callback:function(e){t.$set(t.dsConfig,"dbName",e)},expression:"dsConfig.dbName"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"owner"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("负责人")]),t._v(" "),a("Input",{staticStyle:{width:"285px"},attrs:{placeholder:"owner"},model:{value:t.dsConfig.owner,callback:function(e){t.$set(t.dsConfig,"owner",e)},expression:"dsConfig.owner"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"description"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("描述")]),t._v(" "),a("Input",{staticStyle:{width:"285px"},attrs:{type:"textarea",rows:4,placeholder:"description"},model:{value:t.dsConfig.description,callback:function(e){t.$set(t.dsConfig,"description",e)},expression:"dsConfig.description"}})],1)],2)},staticRenderFns:[]};var P=a("VU/8")(F,L,!1,function(t){a("It0I")},"data-v-862d42f8",null).exports,Z=a("mtWM"),W={components:{jdbcrefConfigForm:P},computed:{init:function(){return this.$store.state.init}},watch:{init:function(){var t=this;t.$store.state.init&&!t.dataInit&&(t.envs=t.$store.state.envs,t.env=t.env?t.env:t.$store.state.currentEnv,t.dataInit=!0)},env:function(){this.currentPage=1,this.searchData(this.currentPage),this.$store.state.currentEnv=this.env}},methods:{initFormatter:function(){Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t}},searchData:function(t){var e=this;Z.get("/i/jdbcref/findJbdcrefByEnv",{params:{env:e.env,page:t||e.currentPage,size:e.pageSize,jdbcrefFilter:e.jdbcref}}).then(function(t){e.jdbcrefList=t.data.jdbcrefList,e.total=t.data.total}).catch(function(t){console.error(t.message),e.$Notice.error({title:"获取jdbcref列表失败",desc:t.message})}),e.currentPage=t},registerJdbcRef:function(){this.dsConfig.DBAddresses=[],this.editJdbcRefConfigModal=!0,this.dsConfig.DBAddresses.push({DBAddress:"",readOrWrite:"读",weight:0})},removeJdbcRef:function(t){var e=this;e.$Modal.confirm({title:"提示",content:"是否删除"+t,onOk:function(){Z.get("/i/jdbcref/removeJdbcRef",{params:{jdbcref:t,env:e.env}}).then(function(t){"success"===t.data.status?e.$Notice.info({title:t.data.message}):"fail"===t.data.status&&e.$Notice.error({title:"失败",desc:t.data.message}),e.loadJdbcConfig()})}})},save:function(){for(var t=this,e=[],a=0;a<t.dsConfig.DBAddresses.length;++a)"写"===t.dsConfig.DBAddresses[a].readOrWrite?e.push({address:t.dsConfig.DBAddresses[a].DBAddress,writeWeight:1,readWeight:0,userName:t.dsConfig.DBAddresses[a].userName,password:t.dsConfig.DBAddresses[a].password}):e.push({address:t.dsConfig.DBAddresses[a].DBAddress,writeWeight:0,readWeight:t.dsConfig.DBAddresses[a].weight,userName:t.dsConfig.DBAddresses[a].userName,password:t.dsConfig.DBAddresses[a].password});var s={jdbcref:t.dsConfig.jdbcref,env:t.dsConfig.env,owner:t.dsConfig.owner,dbName:t.dsConfig.dbName,description:t.dsConfig.description,dbAddresses:e};Z.post("/i/jdbcref/saveJdbcrefConfig",s).then(function(e){"success"===e.data.status?t.$Notice.info({title:"成功",desc:e.data.message}):t.$Notice.error({title:"失败",desc:e.data.message}),t.loadJdbcConfig()}).catch(function(e){t.$Notice.error({title:"失败",desc:e.message})}),this.editJdbcRefConfigModal=!1},cancel:function(){this.editJdbcRefConfigModal=!1},loadJdbcConfig:function(){var t=this;Z.get("/i/jdbcref/findJbdcrefByEnv",{params:{env:t.env,page:t.currentPage,size:t.pageSize}}).then(function(e){t.jdbcrefList=e.data.jdbcrefList,t.total=e.data.total}).catch(function(e){console.error(e.message),t.$Notice.error({title:"获取jdbcref列表失败",desc:e.message})})}},created:function(){if(this.$store.state.init&&!this.dataInit){var t=this;Z.get("/i/zkConfig/getEnv").then(function(e){t.envs=e.data,t.env=t.envs[0],t.loadJdbcConfig()}).catch(function(e){t.$Notice.error({title:"加载环境列表失败",desc:e.message})}),this.dataInit=!0}this.initFormatter()},data:function(){var t=this;return{dataInit:!1,total:0,currentPage:1,pageSize:15,envs:null,env:null,jdbcref:null,jdbcrefList:[],dsConfig:{env:null,owner:null,jdbcref:null,dbName:null,description:null,DBAddresses:[]},editJdbcRefConfigModal:!1,columns:[{title:"JdbcRef",key:"jdbcref",align:"center"},{title:"数据库配置",key:"groupConfig",align:"center",render:function(t,e){return t("span",{style:{color:"#19be6b",fontSize:"14px"}},"写："+e.row.groupConfig.writeDBNum+" / 读："+e.row.groupConfig.readDBNum)}},{title:"负责人",key:"owner",align:"center"},{title:"更新时间",key:"updateTime",align:"center",render:function(t,e){return e.row.updateTime?t("div",new Date(e.row.updateTime).Format("yyyy-MM-dd hh:mm:ss")):t("div",e.row.updateTime)}},{title:"操作",key:"operate",width:150,align:"center",fixed:"right",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.$router.push("jdbcref/info/"+a.row.jdbcref)}}},"详情"),e("Button",{props:{type:"error",size:"small"},style:{marginLeft:"5px"},on:{click:function(){t.removeJdbcRef(a.row.jdbcref)}}},"删除")])}}]}}},O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px",width:"100%","line-height":"12px",position:"relative"}},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline"}}),t._v("\n                        Home\n                    ")],1),t._v(" "),a("BreadcrumbItem",[t._v("读写分离")])],1)],1)]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px","margin-top":"10px"}},[a("div",{staticClass:"zebra-control-group"},[a("span",[t._v("环境:")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{transfer:!0},model:{value:t.env,callback:function(e){t.env=e},expression:"env"}},t._l(t.envs,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1),t._v(" "),a("div",{staticClass:"zebra-control-group"},[a("span",[t._v("检索:")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"ios-search-outline",placeholder:"jdbcref 输入完成后回车搜索"},on:{"on-enter":function(e){t.searchData(0)}},model:{value:t.jdbcref,callback:function(e){t.jdbcref=e},expression:"jdbcref"}})],1),t._v(" "),a("div",{staticClass:"zebra-control-group",staticStyle:{float:"right"}},[a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.registerJdbcRef}},[t._v("注册JdbcRef")])],1)])]),t._v(" "),a("div",{staticClass:"ivu-card",staticStyle:{padding:"10px","margin-top":"10px"}},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"10px 0 0 0",width:"100%"}},[a("Table",{attrs:{width:"auto",border:"",columns:t.columns,data:t.jdbcrefList,size:"large"}}),t._v(" "),a("Page",{staticStyle:{"padding-top":"10px"},attrs:{total:t.total,size:"small","page-size":t.pageSize},on:{"on-change":t.searchData}})],1)]),t._v(" "),a("Modal",{attrs:{"mask-closable":!1,width:"530"},model:{value:t.editJdbcRefConfigModal,callback:function(e){t.editJdbcRefConfigModal=e},expression:"editJdbcRefConfigModal"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("创建配置项")])]),t._v(" "),a("jdbcrefConfigForm",{ref:"jdbcrefConfigForm",staticStyle:{"margin-left":"10px"},attrs:{dsConfig:t.dsConfig}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var J=a("VU/8")(W,O,!1,function(t){a("f+vk")},"data-v-7b53f1db",null).exports,K=a("mtWM"),U={components:{jdbcrefConfigForm:P},computed:{init:function(){return this.$store.state.init}},watch:{init:function(){var t=this;t.$store.state.init&&!t.dataInit&&(t.envs=t.$store.state.envs,t.env=t.env?t.env:t.$store.state.currentEnv,t.dataInit=!0)},env:function(){this.loadData()},modelLoading:function(){this.modelLoading?this.$Spin.show():this.$Spin.hide()},$route:function(t,e){var a=t.params.jdbcRef;e.params.jdbcRef!=a&&(this.jdbcref=a,this.loadData())}},created:function(){if(this.$store.state.init&&!this.dataInit){var t=this;K.get("/i/jdbcref/findJdbcrefDetil",{params:{jdbcref:t.jdbcref,env:t.$store.state.currentEnv}}).then(function(e){200==e.status?t.dsList=e.data:t.$Notice.error({title:"加载ds列表失败"})}).catch(function(e){console.error(e.message),t.$Notice.error({title:"加载ds列表失败",desc:e.message})}),t.dataInit=!0,t.currentEnv=t.$store.state.currentEnv}},methods:{loadData:function(){var t=this;K.get("/i/jdbcref/findJdbcrefDetil",{params:{jdbcref:t.jdbcref,env:t.$store.state.currentEnv}}).then(function(e){200==e.status?t.dsList=e.data:t.$Notice.error({title:"加载ds列表失败"})}).catch(function(e){console.error(e.message),t.$Notice.error({title:"加载ds列表失败",desc:e.message})})},editJdbcRef:function(t){this.dsconfigModel=!0},cancel:function(){this.dsconfigModel=!1},save:function(){this.dsconfigModel=!1},viewProperties:function(t){this.propertyList=[],this.propertiesModel=!0;var e=[];e=t.split("&");for(var a=0;a<e.length;++a){var s;s=e[a].split("="),this.propertyList.push({key:s[0],value:s[1]})}},exit:function(){this.propertiesModel=!1},offLine:function(t){var e=this;K.get("/i/jdbcref/dsOffLine",{params:{dsName:t.dsName,env:e.$store.state.currentEnv}}).then(function(t){e.loadData()}).catch(function(a){e.$Notice.error({title:"下线"+t.dsName+"失败！",desc:a.message})})},onLine:function(t){var e=this;K.get("/i/jdbcref/dsOnLine",{params:{dsName:t.dsName,env:e.$store.state.currentEnv}}).then(function(t){e.loadData()}).catch(function(a){e.$Notice.error({title:"上线"+t.dsName+"失败！",desc:a.message})})}},data:function(){var t=this;return{stared:!1,theme:"light",jdbcref:this.$route.params.jdbcRef,dataInit:!1,showDetilTable:!1,dsconfigModel:!1,propertiesModel:!1,dsConfig:{jdbcref:null,key:null,value:null},groupdsMapping:[],columns:[{title:"dsName",key:"dsName",align:"center",render:function(t,e){return t("span",{style:{fontSize:"14px"}},e.row.dsName)}},{title:"IP",key:"ip",align:"center",width:110,render:function(t,e){return t("span",{style:{fontSize:"14px"}},e.row.ip)}},{title:"端口",key:"port",align:"center",width:70,render:function(t,e){return t("span",{style:{fontSize:"14px"}},e.row.port)}},{title:"用户名",key:"username",align:"center"},{title:"密码",key:"password",align:"center"},{title:"JdbcUrl",key:"jdbcUrl",align:"center",width:190,render:function(t,e){var a=e.row.jdbcUrl.substr(0,21)+"...";return t("Tooltip",{props:{placement:"top",content:e.row.jdbcUrl,transfer:!0}},[t("span",{style:{fontSize:"14px"}},a),t("div",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.jdbcUrl)])}},{title:"读/写",key:"readOrWrite",align:"center",width:80,render:function(t,e){return t("span",{style:{fontSize:"14px"}},0!==e.row.weight?"读":"写")}},{title:"流量占比",key:"weight",align:"center",width:100,render:function(t,e){return t("span",{style:{fontSize:"14px"}},e.row.weight)}},{title:"是否在线",key:"active",align:"center",width:100,render:function(t,e){return!0===e.row.active?t("span",{style:{color:"#19be6b",fontSize:"14px"}},"在线"):t("span",{style:{color:"#ff9900",fontSize:"14px"}},"下线")}},{title:"连接池默认参数",key:"properties",align:"center",width:150,render:function(e,a){return e("Button",{props:{type:"text",size:"small"},style:{color:"#19be6b",fontSize:"14px"},on:{click:function(){t.viewProperties(a.row.properties)}}},"查看")}},{title:"操作",key:"operate",width:80,align:"center",render:function(e,a){return!0===a.row.active?e("div",[e("Button",{props:{type:"warning",size:"small"},on:{click:function(){t.offLine(a.row)}}},"下线")]):e("div",[e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.onLine(a.row)}}},"上线")])}}],dsList:[],propertyColumns:[{title:"key",key:"key",align:"center"},{title:"value",key:"value",align:"center"}],propertyList:[]}}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body"},[a("Table",{attrs:{width:"auto",size:"large",border:"",columns:t.columns,data:t.dsList}}),t._v(" "),a("Page",{staticStyle:{"padding-top":"10px"},attrs:{total:t.total,size:"small","page-size":t.pageSize},on:{"on-change":t.searchData}})],1)]),t._v(" "),a("Modal",{attrs:{title:"配置设置",width:"600","mask-closable":!1},model:{value:t.dsconfigModel,callback:function(e){t.dsconfigModel=e},expression:"dsconfigModel"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("\n            配置设置("+t._s(t.jdbcref)+")\n        ")]),t._v(" "),a("jdbcrefConfigForm",{ref:"jdbcrefConfigForm",staticStyle:{"margin-left":"10px"},attrs:{dsConfig:t.dsConfig}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.save}},[t._v("保存")])],1)],1),t._v(" "),a("Modal",{attrs:{title:"连接池默认参数",width:"500"},model:{value:t.propertiesModel,callback:function(e){t.propertiesModel=e},expression:"propertiesModel"}},[a("Table",{attrs:{width:"auto",size:"large",border:"",columns:t.propertyColumns,data:t.propertyList}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.exit}},[t._v("我知道了")])],1)],1)],1)],1)},staticRenderFns:[]};var H=a("VU/8")(U,V,!1,function(t){a("6lkG")},"data-v-1fda7d34",null).exports,q=a("mtWM"),G={computed:{init:function(){return this.$store.state.init}},watch:{init:function(){var t=this;t.$store.state.init&&!t.dataInit&&(t.envs=t.$store.state.envs,t.env=t.env?t.env:t.$store.state.currentEnv,t.dataInit=!0)},env:function(){this.currentPage=1,this.searchData(this.currentPage),this.$store.state.currentEnv=this.env}},methods:{searchData:function(t){var e=this;q.get("/i/shard/findRuleNameByEnv",{params:{env:e.env,page:t||e.currentPage,size:e.pageSize,shardFilter:e.ruleName}}).then(function(t){e.shardList=t.data.shardList,e.total=t.data.total}).catch(function(t){console.error(t.message),e.$Notice.error({title:"获取ruleName列表失败",desc:t.message})}),e.currentPage=t},removeRuleName:function(t){var e=this;this.$Modal.confirm({content:"确认删除"+t+"?",onOk:function(){e.doRemoveRuleName(t)}})},doRemoveRuleName:function(t){var e=this;q.get("/i/shard/deleteRuleNameConfig",{params:{ruleName:t,env:e.env}}).then(function(t){"success"===t.data.status?e.$Notice.info({title:t.data.message}):e.$Notice.error({title:t.data.message})}).cache(function(t){e.$Notice.error({title:"删除失败",desc:t.message})})},registerRuleName:function(){this.registerRuleNameModal=!0},addRuleName:function(){var t=this;q.get("/i/shard/addRuleName",{params:{ruleName:t.formItem.ruleName,env:t.env,owner:t.formItem.owner,desc:t.formItem.desc}}).then(function(e){"success"===e.data.status?(t.$Notice.info({title:e.data.message}),t.$router.push("/shard/"+t.formItem.ruleName)):"fail"===e.data.status&&t.$Notice.error({title:e.data.message})}).catch(function(e){t.$Notice.error({title:"注册ruleName失败",desc:e.message})})},loadData:function(){var t=this;q.get("/i/shard/findRuleNameByEnv",{params:{env:t.env,page:t.currentPage,size:t.pageSize}}).then(function(e){t.shardList=e.data.shardList,t.total=e.data.total}).catch(function(e){console.error(e.message),t.$Notice.error({title:"获取ruleName列表失败",desc:e.message})})}},created:function(){if(this.$store.state.init&&!this.dataInit){var t=this;q.get("/i/zkConfig/getEnv").then(function(e){t.envs=e.data,t.env=t.envs[0],q.get("/i/shard/findRuleNameByEnv",{params:{env:t.env,page:t.currentPage,size:t.pageSize}}).then(function(e){t.shardList=e.data.shardList,t.total=e.data.total}).catch(function(e){console.error(e.message),t.$Notice.error({title:"获取ruleName列表失败",desc:e.message})})}).catch(function(e){t.$Notice.error({title:"加载Zookeeper地址列表失败",desc:e.message})}),t.dataInit=!0}},data:function(){var t=this;return{dataInit:!1,total:0,currentPage:1,pageSize:15,env:null,envs:[],ruleName:null,shardList:[],rowChosed:"",registerRuleNameModal:!1,formItem:{ruleName:"",physicalDbs:"",owner:"",desc:""},columns:[{title:"ruleName",key:"ruleName",width:220},{title:"负责人",key:"owner",width:160,align:"center"},{title:"描述",key:"desc",align:"center"},{title:"修改时间",key:"updateTime",width:280,align:"center"},{title:"操作",key:"operate",width:160,align:"center",fixed:"right",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$router.push("/shard/"+a.row.ruleName)}}},"详情"),e("Button",{props:{type:"error",size:"small"},style:{marginLeft:"5px"},on:{click:function(){t.removeRuleName(a.row.ruleName)}}},"删除")])}}]}}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px",width:"100%","line-height":"12px",position:"relative"}},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline"}}),t._v("\n                    Home\n                ")],1),t._v(" "),a("BreadcrumbItem",[t._v("分库分表")])],1)],1)]),t._v(" "),a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px","margin-top":"10px"}},[a("div",{staticClass:"zebra-control-group"},[a("span",[t._v("环境:")]),t._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{transfer:!0},model:{value:t.env,callback:function(e){t.env=e},expression:"env"}},t._l(t.envs,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1),t._v(" "),a("div",{staticClass:"zebra-control-group"},[a("span",[t._v("检索:")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"ios-search-outline",placeholder:"ruleName 输入完成后回车搜索"},on:{"on-enter":function(e){t.searchData(0)}},model:{value:t.ruleName,callback:function(e){t.ruleName=e},expression:"ruleName"}})],1),t._v(" "),a("div",{staticClass:"zebra-control-group",staticStyle:{float:"right"}},[a("Button",{attrs:{type:"primary"},on:{click:t.registerRuleName}},[t._v("注册ruleName")])],1)])]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card",staticStyle:{padding:"10px","margin-top":"10px"}},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"10px 0 0 0",width:"100%"}},[a("Table",{attrs:{width:"auto",border:"",columns:t.columns,size:"large",data:t.shardList}}),t._v(" "),a("Page",{staticStyle:{"padding-top":"10px"},attrs:{total:t.total,size:"small","page-size":t.pageSize},on:{"on-change":t.searchData}})],1)])])],1),t._v(" "),a("Modal",{attrs:{title:"注册ruleName",width:"400","mask-closable":!1},on:{"on-ok":t.addRuleName},model:{value:t.registerRuleNameModal,callback:function(e){t.registerRuleNameModal=e},expression:"registerRuleNameModal"}},[a("Form",{attrs:{model:t.formItem,"label-width":80,"label-position":"left"}},[a("FormItem",{attrs:{label:"ruleName"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("ruleName")]),t._v(" "),a("Input",{attrs:{placeholder:"ruleName"},model:{value:t.formItem.ruleName,callback:function(e){t.$set(t.formItem,"ruleName",e)},expression:"formItem.ruleName"}})],1),t._v(" "),a("FormItem",{attrs:{label:"负责人"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("负责人")]),t._v(" "),a("Input",{attrs:{placeholder:"owner"},model:{value:t.formItem.owner,callback:function(e){t.$set(t.formItem,"owner",e)},expression:"formItem.owner"}})],1),t._v(" "),a("FormItem",{attrs:{label:"描述"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("描述")]),t._v(" "),a("Input",{attrs:{placeholder:"description"},model:{value:t.formItem.desc,callback:function(e){t.$set(t.formItem,"desc",e)},expression:"formItem.desc"}})],1)],1)],1),t._v(" "),a("Modal",{on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.removeRuleNameModal,callback:function(e){t.removeRuleNameModal=e},expression:"removeRuleNameModal"}},[a("p",[t._v("Content of dialog")]),t._v(" "),a("p",[t._v("Content of dialog")]),t._v(" "),a("p",[t._v("Content of dialog")])])],1)},staticRenderFns:[]},Q=a("VU/8")(G,X,!1,null,null,null).exports,Y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px",width:"100%","line-height":"12px",position:"relative"}},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline"}}),t._v("\n          Home\n        ")],1),t._v(" "),a("BreadcrumbItem",{attrs:{to:"/shardOverview"}},[t._v("\n          RuleName概览\n        ")]),t._v(" "),a("BreadcrumbItem",[t._v(t._s(t.ruleName))])],1)],1)]),t._v(" "),a("div",{staticClass:"router_container",staticStyle:{"margin-top":"10px"}},[a("router-view")],1)])],1)},staticRenderFns:[]};var tt=a("VU/8")({watch:{$route:function(t,e){this.ruleName=t.params.ruleName}},computed:{currentMenu:function(){var t=this.$route.path,e=t.lastIndexOf("/");return t.substr(e+1,t.length)}},data:function(){return{theme:"primary",ruleName:this.$route.params.ruleName}},methods:{select:function(t){this.currentMenu=t;var e=this.$route.params.ruleName;this.$router.push("/shard/"+e+"/"+t)}}},Y,!1,function(t){a("bTKF")},"data-v-4a7fdc9d",null).exports,et=a("mtWM"),at={components:{Icon:f},computed:{staredShards:function(){return this.$store.state.staredShards},init:function(){return this.$store.state.init}},watch:{staredShards:function(){this.isStaredShard()},$route:function(t,e){this.ruleName=t.params.ruleName,this.isStaredShard()},init:function(){var t=this;t.$store.state.init&&!t.dataInit&&(t.envs=t.$store.state.envs,t.env=t.env?t.env:t.$store.state.currentEnv,t.dataInit=!0)},env:function(){this.loadData()}},methods:{loadData:function(){var t=this;et.get("/i/shard/findRuleName",{params:{env:t.env,ruleName:t.ruleName}}).then(function(e){if(200==e.status){if(t.shardRule=e.data.tableShardConfigs,null!=t.shardRule)for(var a=0;a<t.shardRule.length;++a)t.shardRuleTab.push(!0)}else t.$Notice.error({title:"查询ruleName失败"})}).catch(function(e){console.error(e.message),t.$Notice.error({title:"查询ruleName失败",desc:e.message})})},createConfig:function(){this.shardRule=[{tableName:"table_new",generatedPK:"",global:!1,dimensionConfigs:[{isMaster:!1,needSync:!1,dbRule:"",dbIndexes:"",tbRule:"",tbSuffix:"",tbSuffixZeroPadding:""}]}],this.shardRuleTab[0]=!0},isStaredShard:function(){this.stared=!1,"undefined"!=this.staredShards&&null!=this.staredShards&&this.staredShards.length>0&&this.staredShards.indexOf(this.ruleName)>=0&&(this.stared=!0)},handleTabRemove:function(t){this.shardRule.splice(t,1)},handleTabsAdd:function(){this.shardRule.push({tableName:"table_new",generatedPK:"",global:!1,dimensionConfigs:[{isMaster:!1,needSync:!1,dbRule:"",dbIndexes:"",tbRule:"",tbSuffix:"",tbSuffixZeroPadding:""}]})},saveRule:function(){var t=this,e={ruleName:t.ruleName,env:t.env,tableShardConfigs:t.shardRule};et.post("/i/shard/saveRuleNameConfig",e).then(function(e){"success"===e.data.status?t.$Notice.info({title:"保存成功!"}):t.$Notice.error({title:"保存失败!"})}).catch(function(e){t.$Notice.error({title:"保存失败!",desc:e.message})})}},created:function(){if(this.$store.state.init&&!this.dataInit){this.loadData(),this.dataInit=!0}},data:function(){return{theme:"light",env:this.$store.state.currentEnv,ruleName:this.$route.params.ruleName,stared:!1,dataInit:!1,shard:{},shardRule:[],shardRuleTab:[]}}},st={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("div",{staticClass:"ivu-card",staticStyle:{padding:"8px"}},[a("div",{staticClass:"ivu-card-body"},[t.shardRule&&0!=t.shardRule.length?t.shardRule&&t.shardRule.length>0?a("div",[a("Tabs",{staticStyle:{border:"rgb(221, 217, 217) solid 1px"},attrs:{type:"card",closable:""},on:{"on-tab-remove":t.handleTabRemove}},[t._l(t.shardRule,function(e,s){return a("TabPane",{key:e.tableName,attrs:{label:e.tableName,name:s}},[a("div",{staticClass:"zebra-form-body"},[a("span",{staticStyle:{"padding-right":"4px"}},[t._v("表名:\n                                "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"table name",autofocus:!0},model:{value:e.tableName,callback:function(a){t.$set(e,"tableName",a)},expression:"tb.tableName"}})],1)]),t._v(" "),e.dimensionConfigs&&e.dimensionConfigs.length>0?a("div",{staticClass:"zebra-form-body",staticStyle:{"padding-top":"4px"}},[a("span",{staticStyle:{display:"block"}},[t._v("多维度配置:")]),t._v(" "),t._l(e.dimensionConfigs,function(e){return a("div",{staticClass:"ivu-card-body",staticStyle:{"background-color":"rgb(212, 229, 245)","margin-top":"8px"}},[a("Checkbox",{staticStyle:{"padding-left":"8px","margin-left":"4px"},model:{value:e.isMaster,callback:function(a){t.$set(e,"isMaster",a)},expression:"dimensionConfig.isMaster"}},[t._v("主维度")]),t._v(" "),a("div",{staticClass:"zebra-form-body",staticStyle:{"padding-top":"4px"}},[a("span",{staticStyle:{"padding-right":"4px"}},[t._v("库路由规则:\n                                        "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"dbRule"},model:{value:e.dbRule,callback:function(a){t.$set(e,"dbRule",a)},expression:"dimensionConfig.dbRule"}})],1),t._v(" "),a("span",{staticStyle:{"padding-right":"4px"}},[t._v("库索引:\n                                        "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"dbIndexes"},model:{value:e.dbIndexes,callback:function(a){t.$set(e,"dbIndexes",a)},expression:"dimensionConfig.dbIndexes"}})],1),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{"padding-right":"4px"}},[t._v("表路由规则:\n                                        "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"tbRule"},model:{value:e.tbRule,callback:function(a){t.$set(e,"tbRule",a)},expression:"dimensionConfig.tbRule"}})],1),t._v(" "),a("span",{staticStyle:{"padding-right":"4px"}},[t._v("表后缀:\n                                        "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"tbSuffix"},model:{value:e.tbSuffix,callback:function(a){t.$set(e,"tbSuffix",a)},expression:"dimensionConfig.tbSuffix"}})],1),t._v(" "),a("Checkbox",{staticStyle:{"padding-right":"4px"},model:{value:e.tbSuffixZeroPadding,callback:function(a){t.$set(e,"tbSuffixZeroPadding",a)},expression:"dimensionConfig.tbSuffixZeroPadding"}},[t._v("ZeroPadding")])],1)],1)})],2):t._e()])}),t._v(" "),a("Button",{attrs:{slot:"extra",type:"ghost"},on:{click:t.handleTabsAdd},slot:"extra"},[a("Icon",{attrs:{type:"plus"}})],1)],2),t._v(" "),a("Button",{staticStyle:{"margin-left":"93%","margin-top":"5px"},attrs:{type:"primary"},on:{click:t.saveRule}},[t._v("保存")])],1):t._e():a("div",[t._v("\n                配置不存在\n                "),a("a",{on:{click:t.createConfig}},[t._v("点此创建")]),t._v("配置\n            ")])])])])},staticRenderFns:[]};var nt=a("VU/8")(at,st,!1,function(t){a("yZsT")},"data-v-56a4e6bd",null).exports,it=a("mtWM"),rt={name:"ZKConfig",created:function(){this.initData()},data:function(){var t=this;return{ZKAddrList:[],ZKAddrModal:!1,zkConfig:{zkAddr:null,env:null,description:null},ZKColumns:[{title:"编号",key:"id",width:100,align:"center",sortable:!0,sortType:"desc"},{title:"环境",key:"name",width:200,align:"center"},{title:"zookeeper地址",key:"host",width:250,align:"center"},{title:"备注",key:"description",align:"center"},{title:"操作",align:"center",width:100,render:function(e,a){return e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.deleteZKConfig(a.row.id)}}},"删除")}}]}},methods:{addZKAddr:function(){this.ZKAddrModal=!0},saveZKAddr:function(){var t=this,e={host:t.zkConfig.zkAddr,name:t.zkConfig.env,description:t.zkConfig.description};it.post("/i/zkConfig/addZKConfig",e).then(function(e){"success"===e.data.status?t.$Notice.info({title:"增加zookeeper配置成功"}):t.$Notice.error({title:"增加zookeeper配置失败"}),t.initData()}).catch(function(e){t.$Notice.error({title:"增加zookeeper配置失败",desc:e.message})})},initData:function(){var t=this;it.get("/i/zkConfig/findZKConfig").then(function(e){t.ZKAddrList=e.data}).catch(function(e){t.$Notice.error({title:"加载ZookeeperConfig列表失败",desc:e.message})})},deleteZKConfig:function(t){var e=this;it.get("/i/zkConfig/deleteZKConfig",{params:{id:t}}).then(function(t){"success"===t.data.status?e.$Notice.info({title:"删除成功"}):e.$Notice.error({title:"删除失败"}),e.initData()}).catch(function(t){e.$Notice.error({title:"删除失败",desc:t.message})})}}},ot={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",[a("Col",[a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px",width:"100%","line-height":"12px",position:"relative"}},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline"}}),t._v("\n                        Home\n                    ")],1),t._v(" "),a("BreadcrumbItem",[t._v("环境配置")])],1)],1)]),t._v(" "),a("div",{staticClass:"ivu-card"},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"12px","margin-top":"10px"}},[a("div",{staticClass:"zebra-control-group"},[a("Button",{attrs:{type:"primary"},on:{click:t.addZKAddr}},[t._v("添加环境")])],1)])]),t._v(" "),a("div",{staticClass:"ivu-card",staticStyle:{padding:"10px","margin-top":"10px"}},[a("div",{staticClass:"ivu-card-body",staticStyle:{padding:"10px 0 0 0",width:"100%"}},[a("Table",{attrs:{width:"1000",border:"",columns:t.ZKColumns,size:"large",data:t.ZKAddrList}})],1)]),t._v(" "),a("Modal",{attrs:{title:"添加Zookeeper地址",width:"450","mask-closable":!1},on:{"on-ok":t.saveZKAddr},model:{value:t.ZKAddrModal,callback:function(e){t.ZKAddrModal=e},expression:"ZKAddrModal"}},[a("Form",{attrs:{model:t.zkConfig,"label-position":"left","label-width":120}},[a("FormItem",{attrs:{prop:"zkAddr"}},[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("zookeeper地址")]),t._v(" "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"zookeeper地址"},model:{value:t.zkConfig.zkAddr,callback:function(e){t.$set(t.zkConfig,"zkAddr",e)},expression:"zkConfig.zkAddr"}})],1),t._v(" "),a("FormItem",[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("环境")]),t._v(" "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"环境"},model:{value:t.zkConfig.env,callback:function(e){t.$set(t.zkConfig,"env",e)},expression:"zkConfig.env"}})],1),t._v(" "),a("FormItem",[a("span",{staticStyle:{"font-size":"14px",color:"#464c5b"},attrs:{slot:"label"},slot:"label"},[t._v("描述")]),t._v(" "),a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"描述"},model:{value:t.zkConfig.description,callback:function(e){t.$set(t.zkConfig,"description",e)},expression:"zkConfig.description"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var lt=a("VU/8")(rt,ot,!1,function(t){a("TUMR")},"data-v-64e4e0a2",null).exports,dt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"inline-block",width:"100%"}},[a("Breadcrumb",{staticStyle:{padding:"10px",background:"#fff","margin-bottom":"10px"}},[a("BreadcrumbItem",{attrs:{to:"/"}},[a("Icon",{attrs:{type:"ios-home-outline"}}),t._v("\n        Home\n      ")],1),t._v(" "),a("BreadcrumbItem",[a("Icon",{attrs:{type:"social-buffer-outline"}}),t._v("\n        "+t._s(t.path)+"\n      ")],1)],1)],1),t._v(" "),a("router-view")],1)},staticRenderFns:[]};var ct=[{path:"*",redirect:"/"},{path:"/",redirect:"/home"},{path:"/home",component:E},{path:"/jdbcrefOverview",component:J},{path:"/shardOverview",component:Q},{name:"shard",path:"/shard/:ruleName",component:tt,children:[{path:"/",redirect:"/shard/:ruleName/info"},{path:"/shard/:ruleName/info",component:nt}]},{name:"jdbcref",path:"/jdbcref/:jdbcRef",component:a("VU/8")({data:function(){return{path:this.$route.params.jdbcRef,currentMenu:"/jdbcref/info"}},methods:{select:function(t){this.currentMenu=t;var e=this.$route.params.jdbcRef;this.$router.push(t+"/"+e)},resetCurrentMenu:function(){this.currentMenu="/jdbcref/info"}},watch:{$route:function(t,e){var a=t.params.jdbcRef;e.params.jdbcRef!=a&&(this.path=a,this.resetCurrentMenu())}},created:function(){var t=this.$route.params.jdbcRef,e=this.$route.path;this.currentMenu=e.substr(0,e.length-t.length-1)}},dt,!1,function(t){a("ypdA")},"data-v-3ea90c61",null).exports,children:[{path:"/",redirect:"/jdbcref/info/:jdbcRef"},{path:"/jdbcref/info/:jdbcRef",component:H}]},{path:"/envConfig",component:lt}],ut=a("NYxO"),pt=a("V8mf"),vt=a.n(pt),ft=(a("FBSW"),a("wk2l"),a("Lxn6")),ht=a.n(ft),mt=a("XLwt"),gt=a.n(mt);s.default.use(r.a),s.default.use(i.a),s.default.use(ut.a),s.default.use(ht.a),s.default.prototype.$echarts=gt.a,s.default.prototype.makehl=function(t){return vt.a.highlightAuto(t).value};var bt=new r.a({routes:ct}),yt=new ut.a.Store({state:{init:!0,currentEnv:"test",envs:["test"],user:"",staredJdbcrefs:[],staredShards:[],staredJdbcrefDtos:[],staredShardDtos:[]},getters:{},mutations:{},actions:{}});new s.default({el:"#app",store:yt,router:bt,render:function(t){return t(z)}})},NRQY:function(t,e){},TUMR:function(t,e){},bTKF:function(t,e){},"f+vk":function(t,e){},t8sK:function(t,e){},vfVZ:function(t,e){},wk2l:function(t,e){},yZsT:function(t,e){},ypdA:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.42aa6a7ea30d253328e7.js.map